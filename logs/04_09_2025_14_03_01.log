[ 2025-04-09 14:03:01,927 ] asyncio - DEBUG - Using selector: KqueueSelector
[ 2025-04-09 14:03:02,549 ] root - INFO - Starting model training
[ 2025-04-09 14:03:02,549 ] root - INFO - Pipeline started
[ 2025-04-09 14:03:02,549 ] root - INFO - Starting model pusher
[ 2025-04-09 14:03:02,549 ] root - INFO - Starting model trainer
[ 2025-04-09 14:03:02,549 ] root - INFO - Starting data transformation
[ 2025-04-09 14:03:02,549 ] root - INFO - Starting data ingestion
[ 2025-04-09 14:03:02,549 ] root - INFO - Initiating data ingestion
[ 2025-04-09 14:03:02,549 ] root - INFO - Creating directory: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_ingestion/feature_store
[ 2025-04-09 14:03:02,549 ] root - INFO - Creating directory: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_ingestion/ingested
[ 2025-04-09 14:03:02,549 ] root - INFO - Loading sample data
[ 2025-04-09 14:03:02,549 ] root - INFO - Loading sample data from existing train.csv
[ 2025-04-09 14:03:02,552 ] root - INFO - Shape of dataframe: (400, 45)
[ 2025-04-09 14:03:02,555 ] root - INFO - Data saved to feature store at: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_ingestion/feature_store/Study_Data.csv
[ 2025-04-09 14:03:02,555 ] root - INFO - Splitting data into train and test sets
[ 2025-04-09 14:03:02,559 ] root - INFO - Train and test data saved at: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_ingestion/ingested/train.csv, /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_ingestion/ingested/test.csv
[ 2025-04-09 14:03:02,559 ] root - INFO - Data ingestion completed
[ 2025-04-09 14:03:02,559 ] root - INFO - Data Transformation Initialization
[ 2025-04-09 14:03:02,559 ] root - INFO - Starting data transformation
[ 2025-04-09 14:03:02,562 ] root - INFO - Available columns in train_df: ['Age', 'Sex', 'BMI', 'NYHA', 'HR', 'HTN', 'DM', 'Smoker', 'DL', 'BA', 'RBS', 'HbA1C', 'Creatinine', 'Na', 'K', 'Cl', 'Hb', 'TropI', 'CXR', 'ECG', 'LVIDd', 'FS', 'LVIDs', 'LVEF', 'RWMA', 'LAV', 'MI', 'ACS', 'Wall', 'Thrombolysis', 'ICT', 'IRT', 'MR', 'EA', 'DT', 'MPI', 'RR', 'Chest_pain', 'TC', 'LDLc', 'HDLc', 'TG', 'BNP', 'HF']
[ 2025-04-09 14:03:02,562 ] root - INFO - Creating data transformer object
[ 2025-04-09 14:03:02,571 ] root - INFO - Handling imbalanced data using SMOTEENN
[ 2025-04-09 14:03:02,681 ] root - INFO - Data Transformation Artifact: <HF.entity.artifact_entity.DataTransformationArtifact object at 0x31b1d3ca0>
[ 2025-04-09 14:03:02,682 ] root - INFO - Data transformation completed
[ 2025-04-09 14:03:02,682 ] root - INFO - Initiating model trainer
[ 2025-04-09 14:03:02,682 ] root - INFO - Loading transformed training data from /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_transformation/transformed/train.npy
[ 2025-04-09 14:03:02,682 ] root - INFO - Loading transformed testing data from /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/data_transformation/transformed/test.npy
[ 2025-04-09 14:03:02,682 ] root - INFO - Converting string target values to numeric
[ 2025-04-09 14:03:02,682 ] root - INFO - X_train shape: (191, 75), y_train shape: (191,)
[ 2025-04-09 14:03:02,682 ] root - INFO - X_test shape: (80, 75), y_test shape: (80,)
[ 2025-04-09 14:03:02,682 ] root - INFO - Training XGBoost model with optimized parameters
[ 2025-04-09 14:03:02,920 ] root - INFO - Evaluating model performance
[ 2025-04-09 14:03:02,924 ] root - INFO - Classification Report:
              precision    recall  f1-score   support

           0       0.77      0.72      0.74        32
           1       0.82      0.85      0.84        48

    accuracy                           0.80        80
   macro avg       0.79      0.79      0.79        80
weighted avg       0.80      0.80      0.80        80

[ 2025-04-09 14:03:02,924 ] root - WARNING - Model accuracy 0.8 is below expected accuracy 0.85
[ 2025-04-09 14:03:02,924 ] root - INFO - Model performance - Accuracy: 0.8, ROC AUC: 0.8977864583333334, F1 Score: 0.8367346938775511
[ 2025-04-09 14:03:02,925 ] root - INFO - Model saved at: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/model_trainer/trained_model/xgboost_model.pkl
[ 2025-04-09 14:03:02,925 ] root - INFO - Model trainer artifact: <HF.entity.artifact_entity.ModelTrainerArtifact object at 0x31b1d3be0>
[ 2025-04-09 14:03:02,925 ] root - INFO - Model training completed
[ 2025-04-09 14:03:02,925 ] root - INFO - Initiating model pusher
[ 2025-04-09 14:03:02,926 ] root - INFO - Copied model to: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/model_pusher/xgboost_model.pkl
[ 2025-04-09 14:03:02,926 ] root - INFO - Saved model for deployment at: saved_models/09_04_2025_14_03_01/xgboost_model.pkl
[ 2025-04-09 14:03:02,926 ] root - INFO - Created latest model at: /Users/khalid/Desktop/ML-Model-Deployment/artifact/HF_09_04_2025_14_03_01/model_pusher/latest/xgboost_model.pkl
[ 2025-04-09 14:03:02,926 ] root - INFO - Model pusher artifact: <HF.entity.artifact_entity.ModelPusherArtifact object at 0x31b2c6f10>
[ 2025-04-09 14:03:02,926 ] root - INFO - Model pushing completed
[ 2025-04-09 14:03:02,926 ] root - INFO - Pipeline completed successfully
[ 2025-04-09 14:03:02,926 ] root - INFO - Model training completed. Model saved at: saved_models/09_04_2025_14_03_01/xgboost_model.pkl
[ 2025-04-09 14:03:02,926 ] root - INFO - Starting sample prediction
[ 2025-04-09 14:03:02,927 ] root - INFO - Sample data saved to sample_data.csv
[ 2025-04-09 14:03:02,927 ] root - INFO - Starting batch prediction on file: sample_data.csv
[ 2025-04-09 14:03:02,928 ] root - INFO - Loaded data with shape: (4, 33)
[ 2025-04-09 14:03:02,928 ] root - INFO - Starting prediction pipeline
[ 2025-04-09 14:03:02,928 ] root - INFO - Initiating model prediction
[ 2025-04-09 14:03:02,928 ] root - INFO - Making predictions
[ 2025-04-09 14:03:02,928 ] root - INFO - Loading model from saved_models/latest/xgboost_model.pkl
[ 2025-04-09 14:03:02,929 ] root - INFO - Preprocessing input data for prediction
[ 2025-04-09 14:03:02,929 ] root - INFO - Loading prediction parameters from config/prediction_params.yaml
[ 2025-04-09 14:03:02,931 ] root - INFO - Preprocessed data shape: (4, 33)
[ 2025-04-09 14:03:02,932 ] root - ERROR - Error in prediction pipeline: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [176] error message [Error in model prediction: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [115] error message [Error making predictions: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:HF: object]]
[ 2025-04-09 14:03:02,932 ] root - INFO - Batch prediction completed. Results saved to: prediction_error.txt
[ 2025-04-09 14:03:02,933 ] root - INFO - Predictions (columns available: ['Error in prediction: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [176] error message [Error in model prediction: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [115] error message [Error making predictions: DataFrame.dtypes for data must be int', ' float', ' bool or category. When categorical type is supplied', ' the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:HF: object]]']):
Empty DataFrame
Columns: [Error in prediction: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [176] error message [Error in model prediction: Error occurred python script name [/Users/khalid/Desktop/ML-Model-Deployment/HF/components/model_prediction.py] line number [115] error message [Error making predictions: DataFrame.dtypes for data must be int,  float,  bool or category. When categorical type is supplied,  the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:HF: object]]]
Index: []
[ 2025-04-09 14:03:02,933 ] root - INFO - Demo completed successfully
